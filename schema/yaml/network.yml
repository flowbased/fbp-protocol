title: 'Network protocol'
description: 'Protocol for starting and stopping FBP networks, and finding out about their state.'

output:
  stopped:
    description: 'Inform that a given network has stopped.'
    properties:
      time:
        type: "string"
        format: "date-time"
        description: 'time when the network was stopped'
      uptime:
        type: "string"
        format: "date-time"
        description: 'time the network was running, in seconds'
      graph:
        type: "string"
        description: 'graph the action targets'

  started:
    description: 'Inform that a given network has been started.'
    properties:
      time:
        type: "string"
        format: "date-time"
        description: 'time when the network was started'
      graph:
        type: "string"
        description: 'graph the action targets'

  status:
    description: 'Response to a getstatus message.'
    properties:
      running:
        type: "boolean"
        description: 'boolean tells whether the network is running or not'
      graph:
        type: "string"
        description: 'graph the action targets'
      uptime:
        type: "string"
        format: "date-time"
        description: '(optional) time the network has been running, in seconds'

  output:
    description: 'An output message from a running network, roughly similar to STDOUT output of a Unix process, or a line of console.log in JavaScript. Output can also be used for passing images from the runtime to the UI.'
    properties:
      message:
        type: "string"
        description: 'contents of the output line'
      type:
        type: "string"
        enum: ["message", "previewurl"]
        description: '(optional) type of output, either message or previewurl'
      url:
        type: "string"
        format: "uri"
        description: '(optional) URL for an image generated by the runtime'

  error:
    description: 'An error from a running network, roughly similar to STDERR output of a Unix process, or a line of console.error in JavaScript.'
    properties:
      message:
        type: "any"
        description: 'contents of the error message'


  icon:
    description: 'Icon of a component instance has changed.'
    properties:
      id:
        type: "string"
        description: 'identifier of the node'
      icon:
        type: "string"
        description: 'new icon for the component instance'
      graph:
        type: "string"
        description: 'graph the action targets'



  connect:
    description: 'Beginning of transmission on an edge.'
    properties:
      id:
        type: "string"
        description: 'textual edge identifier, usually in form of a FBP language line'
      src:
        type: object
        description: 'source node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      tgt:
        type: object
        description: 'target node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      graph:
        type: "string"
        description: 'graph the action targets'
      subgraph:
        type: "string"
        description: '(optional): subgraph identifier for the event. An array of node IDs'

  begingroup:
    description: 'Beginning of a group (bracket IP) on an edge.'
    properties:
      id:
        type: "string"
        description: 'textual edge identifier, usually in form of a FBP language line'
      src:
        description: 'source node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      tgt:
        description: 'target node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      group:
        description: 'group name'
        type: "string"
      graph:
        type: "string"
        description: 'graph the action targets'
      subgraph:
        type: "array"
        description: '(optional): subgraph identifier for the event. An array of node IDs'

  data:
    description: 'Data transmission on an edge.'
    properties:
      id:
        type: "string"
        description: 'textual edge identifier, usually in form of a FBP language line'
      src:
        type: object
        description: 'source node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      tgt:
        type: object
        description: 'target node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      data:
        type: "any"
        description: 'actual data being transmitted, encoded in a way that can be carried over the protocol transport'
      graph:
        type: "string"
        description: 'graph the action targets'
      subgraph:
        type: "string"
        description: '(optional): subgraph identifier for the event. An array of node IDs'

  endgroup:
    description: 'Ending of a group (bracket IP) on an edge.'
    properties:
      id:
        type: "string"
        description: 'textual edge identifier, usually in form of a FBP language line'
      src:
        description: 'source node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      tgt:
        description: 'target node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      group:
        description: 'group name'
        type: "string"
      graph:
        description: 'graph the action targets'
        type: "string"
      subgraph:
        type: "array"
        description: '(optional): subgraph identifier for the event. An array of node IDs'

  disconnect:
    description: 'End of transmission on an edge.'
    properties:
      id:
        description: 'textual edge identifier, usually in form of a FBP language line'
      src:
        type: object
        description: 'source node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      tgt:
        type: object
        description: 'target node for the edge'
        properties:
          node:
            type: "string"
            description: 'node identifier'
          port:
            type: "string"
            description: 'port name'
      graph:
        type: "string"
        description: 'graph the action targets'
      subgraph:
        type: "string"
        description: '(optional): subgraph identifier for the event. An array of node IDs'



input:

  error:
    description: 'Network error'

  start:
    description: 'Start execution of a FBP network based on a given graph.'
    properties:
      graph:
        type: "string"
        description: 'graph the action targets'

  getstatus:
    description: 'Get the current status of the runtime. The runtime should respond with a status message.'
    properties:
      graph:
        type: "string"
        description: 'graph the action targets'

  stop:
    description: 'Stop execution of a FBP network based on a given graph.'
    properties:
      graph:
        type: "string"
        description: 'graph the action targets'

  edges:
    description: 'List of edges user has selected for inspection in a user interface or debugger, sent from UI to a runtime.'
    edges:
      type: array
      description: 'list of selected edges, each containing'
      properties:
        src:
          type: object
          description: 'source node for the edge'
          properties:
            node:
              type: "string"
              description: 'node identifier'
            port:
              type: "string"
              description: 'port name'
        tgt:
          type: object
          description: 'target node for the edge'
          properties:
            node:
              type: "string"
              description: 'node identifier'
            port:
              type: "string"
              description: 'port name'
            graph:
              type: "string"
              description: 'graph the action targets'
